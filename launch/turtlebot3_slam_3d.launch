<launch>
  <arg name="use_zed"         default="true"  doc="Set to false when using Intel Realsense D435"/>
  <arg name="visual_odom"     default="false" doc="Use ZED visual odometry"/>
  <arg name="rviz"            default="true"/>
  <arg name="publish_detection" default="false"/>
  <arg name="detection_db"    default="$(find turtlebot3_slam_3d)/scripts/detections_dbscan.db"/>
  <arg name="svo_file"        default="" />
  <arg name="use_svo"        default="false" />

  <!--<arg     if="$(arg visual_odom)" name="input_odom"  default="/stereo_camera/odom"/>
  <arg unless="$(arg visual_odom)" name="input_odom"  default="/odom"/>-->

  <!-- CAMERA -->
  <group if="$(arg use_svo)">
    <include if="$(arg use_zed)" file="$(find turtlebot3_slam_3d)/launch/turtlebot3_zed_bringup.launch">
      <arg name="visual_odom" value="$(arg visual_odom)" />
      <arg name="svo_file"    value="$(arg svo_file)"/>
    </include>
  </group>

  <group unless="$(arg use_svo)">
    <include if="$(arg use_zed)" file="$(find turtlebot3_slam_3d)/launch/turtlebot3_zed_bringup.launch">
      <arg name="visual_odom" value="$(arg visual_odom)" />
    </include>
    <include unless="$(arg use_zed)" file="$(find turtlebot3_slam_3d)/launch/turtlebot3_d435_bringup.launch"/>
  </group>

  <!-- RTABMAP -->
  <include file="$(find turtlebot3_slam_3d)/launch/rtabmap.launch">
    <arg name="use_zed"    value="$(arg use_zed)"/>
    <arg name="rviz"       value="false"/>
    <!--<arg name="input_odom" value="$(arg input_odom)"/>-->
  </include>

  <!-- DARKNET -->
  <include file="$(find turtlebot3_slam_3d)/launch/darknet.launch">
    <arg name="use_zed" value="$(arg use_zed)"/>
  </include>

  <!-- DARKNET -->
  <include file="$(find turtlebot3_slam_3d)/launch/depth_to_laser.launch">
    <arg name="svo_file"    value="$(arg svo_file)"/>
  </include>

  <!-- SUBSCRIBER -->
  <!--<node pkg="turtlebot3_slam_3d" type="detection_collector.py"
        name="detection_collector" output="screen"/>-->

  
    <!-- DETECTION_PUBLISHER -->
  <group if="$(arg publish_detection)">
    <node pkg="turtlebot3_slam_3d" type="detection_publisher.py" name="detection_publisher"
          args=" -i $(arg detection_db)" output="screen"/>

    <!-- RVIZ -->
    <node pkg="rviz" type="rviz" name="rviz"
	  args="-d $(find turtlebot3_slam_3d)/config/yolo_markers.rviz" />
  </group>

  <!-- RVIZ -->
  <group unless="$(arg publish_detection)">
    <node if="$(arg rviz)" pkg="rviz" type="rviz" name="rviz"
    args="-d $(find turtlebot3_slam_3d)/config/yolo.rviz" />
  </group>

</launch>
